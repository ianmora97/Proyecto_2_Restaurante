<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Dely Restaurant </title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="/restaurante/css/bootstrap-datetimepicker.min.css">
        <link rel="stylesheet" href="/restaurante/css/order.css">

        <!--bootstrap css-->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"  crossorigin="anonymous">


    </head>
    <body>
        <!--MODAL PARA LA FECHA-->
        <div class="modal" tabindex="-1" id="modal-date" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Pick a day</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class='input-group date' id='datetimepicker1'>
                                <input type='text' class="form-control" />
                                <span class="input-group-addon">
                                    <span class="glyphicon glyphicon-calendar"><i class="fas fa-calendar-alt"></i></span>
                                </span>
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>
        <!--FIN DEL MODAL--> 

        <!--MODAL PARA LAS ADICIONALES-->
        <div class="modal" tabindex="-1" role="dialog" id="modalOptions">
            <div class="modal-dialog modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Aditionals</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body " id="adtionalModal" >
                        <div class="container ">
                            <div class="row bg-light py-2 my-2">
                                <div class="col-9">
                                    <h5>Adicional # 1</h5>
                                </div>
                                <div class="col-3 text-muted">
                                    Required
                                </div>
                            </div>
                            <div class="row justify-content-between my-1">
                                <div class="col-8">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="customCheck1">
                                        <label class="custom-control-label" for="customCheck1">Hola Mundo</label>
                                    </div>
                                </div>
                                <div class="col-3">
                                    $3
                                </div>
                            </div>
                            <div class="row justify-content-between my-1">
                                <div class="col-8">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input" id="customRadio" name="example1" value="customEx">
                                        <label class="custom-control-label" for="customRadio">Caja de 3</label>
                                    </div>
                                </div>
                                <div class="col-3">
                                    $3
                                </div>
                            </div>
                            <div class="row justify-content-between my-1">
                                <div class="col-8">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input" id="customRadio2" name="example1" value="customEx">
                                        <label class="custom-control-label" for="customRadio2">Caja de 2</label>
                                    </div>
                                </div>
                                <div class="col-3">
                                    $100
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>
        <!--FIN DEL MODAL ADICIONALES-->




        <nav class="navbar navbar-toggleable-sm bg-primary navbar-inverse">

            <div class="container">
                <div class="justify-content-start">
                    <a href="#">
                        <img src="/restaurante/images/logo.png" height="40"/>
                    </a>
                </div>
                <button class="navbar-toggler" data-toggle="collapse" data-target="#mainNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-end" id="mainNav">
                    <div class="navbar-nav">
                        <a class="nav-item nav-link active"  href="#"> View Menu </a>
                        <a class="nav-item nav-link"  href="#"> Reservation</a>
                        <a class="nav-item nav-link"  href="#"> Login</a>
                        <a class="nav-item nav-link"  href="#"> Register</a>
                    </div>
                </div>
            </div>
        </nav>


        <div class="container ">
            <div class="row ">
                <!--inicio de la primera seccion de categorias-->

                <div class="col-sm-6 col-lg-3">
                    <nav class="nav justify-content-center nav-pills flex-column my-4" id="menuCategories">
                        <label id="lbCategories"> Categories</label>
                    </nav>
                </div>
                <!--final de la primera parte de categorias-->

                <!--inicio de la parte intermedia de pedidos-->

                <div class="col-sm-6 col-lg-6">

                    <div class="dropdown my-5">
                        <button class="btn btn-primary dropdown-toggle  btn-block" type="button" data-toggle='dropdown'>
                            <i class="fas fa-clock"></i> &nbsp ASAP
                        </button>
                        <div class="dropdown-menu">
                            <a href="#" class='dropdown-item'> <i class="fas fa-clock"></i> &nbsp  ASAP</a>
                            <button class='dropdown-item btn' id='calendar' type="button"> <i class="fas fa-calendar-alt"></i> &nbsp Schedule Order </button>
                        </div>
                    </div>

                    <!--El siguiente codigo es para presentar los platillos según la categoría.--> 
                    <div class="accordion" >
                        <div class="tab-content py-5" id="dishes">

                        </div>
                    </div>

                </div>
                <!--final de la parte inermedia de pedidos-->


                <!-- inicio De la tercera parte-->
                <div class="col-sm-4 col-lg-3 my-4 ">

                    <div id="cart-box" class="module-box py-3 ">
                        <div class="panel panel-cart ">
                            <div class="panel-body  py-1 px-2">
                                <div id="cart-control">
                                    <div class="btn-group " data-toggle='buttons'>
                                        <label class="btn btn-primary active " >
                                            <input type="radio" name="type" id='delivery' autocomplete='off' checked/>
                                            <strong> Delivery <br/></strong> 
                                            <span  class="small center-block">
                                                in 15 min  
                                            </span>
                                        </label>
                                        <label class="btn btn-primary ">
                                            <input type="radio" name="type" id='pickUp' autocomplete='off' />
                                            <strong> Pick Up <br/></strong>
                                            <span class="small center-block">
                                                Starts 06:00 am  
                                            </span>
                                        </label>
                                    </div>
                                    <div class="text-center center-block">
                                        <p class="text-muted text-center">
                                            No Min. Order Amount        
                                        </p>
                                        <div id="cart-items">
                                            <div class="panel-body"><p class="text-center">Add menu items to your cart.</p></div>
                                        </div>
                                    </div>
                                </div>

                                <div id="cart-totals">
                                </div>

                                <div id="cart-buttons" class="mt-3">
                                    <button class="checkout-btn btn btn-primary  btn-block btn-lg">
                                        Checkout
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!--final-->
            </div>

        </div>

        <!--SCRIPTS--> 

        <!--JQUERY-->
        <script src="https://code.jquery.com/jquery-3.5.1.js"  crossorigin="anonymous"></script>

        <!--date picket src-->       
        <script src="/restaurante/js/bootstrap-datetimepicker.min.js"></script>

        <!--BOOTSTRAP-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"  crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" crossorigin="anonymous"></script>
        <script src="/restaurante/js/calendar.js"  ></script>
        <!--iconos de font awesome-->
        <script src="https://kit.fontawesome.com/39f4ebbbea.js" crossorigin="anonymous"></script>
        <script>
            $(function () {
                $('[data-toggle="tooltip"]').tooltip();
            });
        </script>


        <!--Scripts del programa-->
        <script>
            function loaded(event) {
                fillCategories();
            }

            function fillCategories() {
                $(document).ready(function () {
                    $.ajax({
                        type: "POST",
                        url: "api/restaurante/categorias/get",
                        success: function (categorias) {
                            showCategorias(categorias);
                        },
                        error: function (status) {
                            alert(errorMessage(status));
                        }
                    });
                });
            }
            function showCategorias(categorias) {

                categorias.forEach((cat) => {
                    fillListCategories(cat);
                });


            }
            function fillListCategories(categoria) {
                var nombre = categoria.nombre.replace(/ /g, "");
                var targetAccordion = nombre + "Target";
                var platilloId = nombre + "Platillo";

                $("#menuCategories").append('<a class="nav-link " href="#' + nombre + '" data-toggle="tab">' + categoria.nombre + '</a>');



                $("#dishes").append(
                        '<div class="tab-pane" id="' + nombre + '">' +
                        '<div class="card">' +
                        '<div class="card-header">' +
                        ' <h1 class="mb-0">' +
                        '<button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"' +
                        'data-target="#' + targetAccordion + '">' + categoria.nombre + ' </button>' +
                        ' </h1>' +
                        ' </div>' +
                        '<div id="' + targetAccordion + '" class="collapse show">' +
                        '<div class="card-body" id="' + platilloId + '">' +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>'
                        );

                var platillos = categoria.platilloCollection;
                platillos.forEach((platillo) => {
                    fillDishes(platillo, platilloId);
                });

            }
            function fillDishes(platillo, platilloId) {
                var idEvtAditional = platillo.nombrePlatillo.replace(/ /g, "") + "Adicional";
                $("#" + platilloId).append(
                        '<div class="d-flex flex-row mr-3 mt-3 btn-block">' +
                        ' <div class=" flex-grow-1 " id="firstPart">' +
                        '<h6>' + platillo.nombrePlatillo + '</h6>' +
                        '<p class="text-muted mb-0" id="dishDescription">'
                        + platillo.descripcion + '</p>' +
                        ' </div>' +
                        '<div class=" align-self-start col-3 text-right p-0" id="secondPart">' +
                        '<span class=" pr-sm-3" id="price">' +
                        '<b>' + platillo.precio + '</b>' +
                        ' </span><span class="btnPlus">' +
                        '<button type="button" class="btn btn-light btn-sm btn-cart " data-toggle="modal"' +
                        'data-target="#modalOptions" >' +
                        '<i class="fa fa-plus" id="' + idEvtAditional + '"></i>' +
                        '</button>' +
                        '</span>' +
                        '</div>' +
                        '</div>'
                        );

                $("#" + idEvtAditional).click(function () {
                    getAditional(platillo.adicionalCollection);
                });

            }

            function getAditional(Adicionales) {
                console.log(Adicionales);
                $("#adtionalModal").html(" ");
                if (Adicionales.length !== 0) {
                    Adicionales.forEach((adicional) => {
                        var requerida = "Requerida";
                        if (adicional.requerida === 0) {
                            requerida = "Opcional";
                        }
                        var adicionalSinEspacios = adicional.nombre.replace(/ /g, "");
                        $("#adtionalModal").append('<div class="container" id="' + adicionalSinEspacios + '">' +
                                '<div class="row bg-light py-2 my-2">' +
                                '<div class="col-9">' +
                                '<h5>' + adicional.nombre + '</h5>' +
                                ' </div>' +
                                '<div class="col-3 text-muted">' +
                                requerida +
                                '</div>' +
                                '</div>' +
                                '</div>');
                        fillOptions(adicional);
                    });

                }


            }


            function fillOptions(adicional) {
                var opciones = adicional.opcionCollection;
                var adicionalSinEspacios = adicional.nombre.replace(/ /g, "");

                opciones.forEach((opcion) => {
                    var htmlOption = " ";
                    var opcionesSinEspacios = opcion.nombre.replace(/ /g, "");

                    if (adicional.tipo === 0) {

                        htmlOption = '<div class="row justify-content-between my-1">' +
                                ' <div class="col-8">' +
                                ' <div class="custom-control custom-radio">' +
                                '<input type="radio" class="custom-control-input" id="' + opcionesSinEspacios + '" name="' + adicionalSinEspacios + "Id" + '" value="customEx">' +
                                '<label class="custom-control-label" for="' + opcionesSinEspacios + '">' + opcion.nombre + '/label>' +
                                '</div>' +
                                '</div>' +
                                '<div class="col-3">' +
                                opcion.precio +
                                '</div>' +
                                '</div>';
                    } else {
                        htmlOption = '<div class="row justify-content-between my-1">' +
                                '<div class="col-8">' +
                                '<div class="custom-control custom-checkbox">' +
                                '<input type="checkbox" class="custom-control-input" id="' + opcionesSinEspacios + '">' +
                                '<label class="custom-control-label" for="' + opcionesSinEspacios+ '">' + opcion.nombre + '</label>' +
                                ' </div>' +
                                '</div>' +
                                '<div class="col-3">' +
                                opcion.precio +
                                '</div>' +
                                '</div>';
                    }
                    $("#" + adicionalSinEspacios).append(htmlOption);
                });
            }

            function errorMessage(status) {
                return "Ha ocurrido un error";
            }

            document.addEventListener("DOMContentLoaded", loaded);

        </script>
    </body>



</html>


