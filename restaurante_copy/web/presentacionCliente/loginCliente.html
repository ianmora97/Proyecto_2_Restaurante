<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Login - Cliente</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" type="image/x-icon" href="/restaurante_copy/images/logo.png" />
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"  crossorigin="anonymous">
        <link rel="stylesheet" href="/restaurante_copy/css/footer.css">
        <link rel="stylesheet" href="/restaurante_copy/css/general.css">

    </head>

    <body  style="background-color: #EEEDED;">

        <!--Barra de navegación principal superior-->
        <nav class="navbar navbar-expand-sm bg-white  navbar-inverse">
            <div class="container">
                <div class="justify-content-start">
                    <a href="#">
                        <img src="/restaurante_copy/images/logo.png" height="40"/>
                    </a>
                </div>
                <button class="navbar-toggler" data-toggle="collapse" data-target="#mainNav">
                    <span class="fas fa-align-justify"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-end" id="mainNav">
                    <div class="navbar-nav">
                        <a class="nav nav-link active "  href="/restaurante_copy/index.html" > View Menu </a>
                        <a class="nav-item nav-link"  href="/restaurante_copy/presentacionCliente/reservation.html"> Reservation</a>
                        <a class="nav-item nav-link"  href="/restaurante_copy/presentacionCliente/loginCliente.html" id="loginAnchor"> Login</a>
                        <a class="nav-item nav-link"  href="/restaurante_copy/presentacionCliente/register.html" id="registerAnchor"> Register</a>
                        <div class="dropdown">
                            <button class="btn  dropdown-toggle" type="button" id="dropdownMenuBtn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: #ED561A;">
                                User
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuBtn">
                                <a class="dropdown-item" href="/restaurante_copy/presentacionCliente/perfil.html" >My profile </a>
                                <a class="dropdown-item" href="#" id="logOutAnchor">Log Out</a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </nav>

        <div id="page-wrapper">
            <div class="container">
                <div class="row">
                    <div class="col-sm-4 mx-auto my-5">
                        <div class="card">
                            <div class="card-body">
                                <h1 class="card-title h4 mb-4 font-weight-normal">
                                    Log In                    </h1>

                                <div class="form-group">
                                    <div class="input-group my-3">
                                        <input type="text" name="email" id="input-user" class="form-control input-lg" placeholder="Email Address" autofocus="" required>
                                        <span class="input-group-addon">
                                            <span class="input-group-text">@</span>
                                        </span>
                                    </div>

                                    <div class="input-group my-3">
                                        <input type="password" name="password" id="input-password" class="form-control input-lg" placeholder="New Password"  required>
                                        <span class="input-group-addon">
                                            <span class="input-group-text" style="padding-bottom: 10px; padding-top: 13px;"><i class="fa fa-lock"> </i></span>
                                        </span>
                                    </div>

                                    <div class="row">
                                        <div class="col-12">
                                            <button type="submit" class="btn orange btn-block btn-lg" id='sendLogin'>Login</button>
                                        </div>
                                    </div>
                                    <div id="incorrect" class="alert alert-danger" role="alert" >
                                        <strong>Incorrect</strong> usarname or Password!
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7">
                                        <a class="btn btn-outline-dark btn-block btn-lg" href="presentacionCliente/register.html">Register </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="pt-5">
            <div class="footer pt-5 pb-5">
                <div class="container text-white">
                    <div class="row">
                        <div class="col-sm-3">
                            <div class="footer-links">
                                <h6 class="footer-title d-none d-sm-block">Proyecto de Programacion 4</h6>
                                <ul>
                                    <li>
                                        <a href="#">David Aguilar Rojas</a>
                                    </li>
                                    <li>
                                        <a href="#">Ian Mora Rodriguez</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-sm-3">
                            <div class="footer-links">
                                <h6 class="footer-title d-none d-sm-block">Information</h6>
                                <ul>
                                    <li>
                                        <a href="#">Profesor: Jose Sanchez</a>
                                    </li>

                                </ul>
                            </div>
                        </div>

                        <div class="col-sm-3 mt-3 mt-sm-0">
                            <div class="social-bottom">
                                <h6 class="footer-title" style="display: inline-block;">Follow us on</h6>
                                <ul class="social-icons list-inline" >
                                    <li>
                                        <a class="p-2 fab fa-facebook" target="_blank" title="Facebook" href="">
                                        </a>
                                    </li>
                                    <li>
                                        <a class="p-2 fab fa-twitter" target="_blank" title="Facebook" href="">
                                        </a>
                                    </li>
                                    <li>
                                        <a class="p-2 fab fa-github" target="_blank" title="Facebook" href="">
                                        </a>
                                    </li>
                                    <li>
                                        <a class="p-2 fab fa-youtube" target="_blank" title="Facebook" href="">
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div class="col-sm-3 mt-3 mt-sm-0">
                            <div id="newsletter-box">
                                <h5 class="mb-4">Subscribe to our newsletter</h5>
                                <form id="subscribeForm" class="subscribe-form" method="POST" >
                                    <div class="input-group subscribe-group">
                                        <input type="text" class="form-control" name="subscribe_email" data-kwimpalastatus="alive" readonly>
                                        <span class="input-group-append">
                                            <button id="subscribeButton" class="btn btn-info"><i class="fa fa-paper-plane"></i></button>
                                        </span>
                                    </div>
                                </form>                    
                            </div>
                        </div>
                    </div>

                    <div class="container">
                        <div class="row">
                            <div class="col">
                                <hr class="mb-3">
                            </div>
                        </div>
                    </div>

                    <div class="container">
                        <div class="row">
                            <div class="col p-2">
                                © 2020 Proyecto Progra 4, Inspirado en: - <a target="_blank" href="http://tastyigniter.com">Powered by TastyIgniter</a>      
                            </div>
                        </div>
                    </div>
                </div>    
            </div>

        </footer>
        <!--JQUERY-->
        <script src="https://code.jquery.com/jquery-3.5.1.js"  crossorigin="anonymous"></script>

        <!--BOOTSTRAP-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"  crossorigin="anonymous"></script>       
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
        <!--iconos de font awesome-->
        <script src="https://kit.fontawesome.com/39f4ebbbea.js" crossorigin="anonymous"></script>

        <script>
            function loaded(event) {
                $("#incorrect").hide();
                events();
            }
            function events() {
                ingresar();
//                getUserInSession();
            }
//            function getUserInSession() {
//                $.ajax({
//                    type: "POST",
//                    url: "/restaurante/api/restaurante/getUser",
//                    success: function (usuario) {
//                        if (usuario !== null) {
//                            $("#registerAnchor").hide();
//                            $("#loginAnchor").hide();
//                            $("#dropdownMenuBtn").show();
//                            $("#dropdownMenuBtn").html(" ");
//                            $("#dropdownMenuBtn").append(usuario.cliente.nombre);
//
//                        } else {
//                            $("#registerAnchor").show();
//                            $("#loginAnchor").show();
//                            $("#dropdownMenuBtn").hide();
//                        }
//                    },
//                    error: function (status) {
//                        alert(errorMessage(status));
//                    }
//                });
//            }
            function ingresar(status) {
                $("#sendLogin").click(function () {
                    var username = $("#input-user").val();
                    var clave = $("#input-password").val();
                    if (clave.length <= 0 || username.length <= 0) {
                        $("#input-user").addClass("error");
                        $("#input-password").addClass("error");
                        $("#incorrect").fadeTo(2000, 300).slideUp(200, function () {
                            $("#incorrect").slideUp(200);
                        });
                    } else {
                        var sendData = {
                            username: username,
                            usuarioCorreo: username,
                            contrasena: clave
                        };
                        $.ajax({
                            type: "POST",
                            url: "/restaurante_copy/api/login",
                            data: JSON.stringify(sendData),
                            contentType: "application/json"
                        }).then((usuario) => {
                            sessionStorage.setItem("usuario", JSON.stringify(usuario));
                            console.log(JSON.parse(sessionStorage.getItem("usuario")));

                        }, (error) => {
                            $("#input-user").addClass("error");
                            $("#input-password").addClass("error");
                            $("#incorrect").fadeTo(2000, 500).slideUp(500, function () {
                                $("#incorrect").slideUp(500);
                            });
                        });
                    }
                });
            }
            document.addEventListener("DOMContentLoaded", loaded);
        </script>
    </body>
</html>
